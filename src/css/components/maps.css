/* ============================================
   Google Maps Component Styles
   Responsive iframe container with loading states
   ============================================ */

/* ============================================
   Map Container - Responsive Wrapper
   ============================================ */
.contact-map__wrapper {
  position: relative;
  width: 100%;
  margin-block-end: var(--space-lg);
  border-radius: var(--radius-lg);
  overflow: hidden;
  box-shadow: var(--shadow-lg);
  background-color: var(--color-neutral-100);
  
  /* Aspect ratio container for responsive iframe */
  aspect-ratio: 16 / 9;
  
  /* Fallback for browsers without aspect-ratio support */
  @supports not (aspect-ratio: 16 / 9) {
    padding-top: 56.25%; /* 16:9 aspect ratio */
  }
  
  /* Performance optimization */
  contain: layout style paint;
  content-visibility: auto;
  contain-intrinsic-size: 0 450px;
}

/* ============================================
   Map Iframe - Full Coverage
   ============================================ */
.contact-map__iframe {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  border: none;
  display: block;
  
  /* Smooth loading transition */
  opacity: 0;
  animation: fade-in 0.3s ease-out 0.2s forwards;
  
  /* Performance hints */
  will-change: opacity;
  transform: translateZ(0);
}

/* ============================================
   Loading State
   ============================================ */
.contact-map__wrapper::before {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(
    135deg,
    var(--color-neutral-100) 0%,
    var(--color-neutral-200) 50%,
    var(--color-neutral-100) 100%
  );
  background-size: 200% 200%;
  animation: loading-shimmer 1.5s ease-in-out infinite;
  z-index: 1;
  pointer-events: none;
}

.contact-map__wrapper::after {
  content: 'Loading map...';
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-medium);
  color: var(--color-text-muted);
  z-index: 2;
  pointer-events: none;
  animation: fade-out 0.3s ease-out 0.5s forwards;
}

/* ============================================
   Loading Animation
   ============================================ */
@keyframes loading-shimmer {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

@keyframes fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes fade-out {
  from {
    opacity: 1;
  }
  to {
    opacity: 0;
    visibility: hidden;
  }
}

/* ============================================
   Responsive Adjustments
   ============================================ */
@media (max-width: 640px) {
  .contact-map__wrapper {
    /* Taller aspect ratio on mobile for better visibility */
    aspect-ratio: 4 / 3;
    border-radius: var(--radius-md);
    
    @supports not (aspect-ratio: 4 / 3) {
      padding-top: 75%; /* 4:3 aspect ratio */
    }
  }
  
  .contact-map__iframe {
    /* Ensure minimum height on small screens */
    min-height: 300px;
  }
}

@media (min-width: 641px) and (max-width: 1023px) {
  .contact-map__wrapper {
    /* Standard aspect ratio for tablets */
    aspect-ratio: 16 / 9;
    
    @supports not (aspect-ratio: 16 / 9) {
      padding-top: 56.25%;
    }
  }
}

@media (min-width: 1024px) {
  .contact-map__wrapper {
    /* Wider aspect ratio for desktop */
    aspect-ratio: 21 / 9;
    
    @supports not (aspect-ratio: 21 / 9) {
      padding-top: 42.857%; /* 21:9 aspect ratio */
    }
  }
  
  .contact-map__iframe {
    /* Optimal height for desktop viewing */
    min-height: 450px;
  }
}

/* ============================================
   Focus State for Accessibility
   ============================================ */
.contact-map__iframe:focus-visible {
  outline: 2px solid var(--color-focus);
  outline-offset: -2px;
}

/* ============================================
   Reduced Motion Support
   ============================================ */
@media (prefers-reduced-motion: reduce) {
  .contact-map__wrapper::before {
    animation: none;
    background: var(--color-neutral-100);
  }
  
  .contact-map__wrapper::after {
    animation: none;
    opacity: 0;
    visibility: hidden;
  }
  
  .contact-map__iframe {
    animation: none;
    opacity: 1;
  }
}

/* ============================================
   High Contrast Mode Support
   ============================================ */
@media (prefers-contrast: high) {
  .contact-map__wrapper {
    border: 2px solid var(--color-border);
  }
  
  .contact-map__wrapper::after {
    color: var(--color-text-primary);
    font-weight: var(--font-weight-bold);
  }
}

/* ============================================
   Dark Mode Adjustments
   ============================================ */
@media (prefers-color-scheme: dark) {
  .contact-map__wrapper {
    background-color: var(--color-neutral-800);
    box-shadow: var(--shadow-xl);
  }
  
  .contact-map__wrapper::before {
    background: linear-gradient(
      135deg,
      var(--color-neutral-800) 0%,
      var(--color-neutral-700) 50%,
      var(--color-neutral-800) 100%
    );
  }
  
  .contact-map__iframe {
    /* Slightly reduce brightness in dark mode */
    filter: brightness(0.9);
  }
}

/* ============================================
   Print Styles
   ============================================ */
@media print {
  .contact-map__wrapper {
    page-break-inside: avoid;
    box-shadow: none;
    border: 1px solid var(--color-border);
  }
  
  .contact-map__wrapper::before,
  .contact-map__wrapper::after {
    display: none;
  }
  
  .contact-map__iframe {
    /* Show placeholder for map in print */
    opacity: 0.3;
  }
  
  .contact-map__wrapper::after {
    content: 'Map available at: https://maps.google.com';
    display: block;
    opacity: 1;
    visibility: visible;
    animation: none;
    font-size: var(--font-size-sm);
    color: black;
  }
}

/* ============================================
   Container Query Support
   ============================================ */
@supports (container-type: inline-size) {
  .contact-map {
    container-type: inline-size;
    container-name: map-section;
  }
  
  @container map-section (width > 768px) {
    .contact-map__wrapper {
      aspect-ratio: 21 / 9;
    }
  }
  
  @container map-section (width <= 640px) {
    .contact-map__wrapper {
      aspect-ratio: 4 / 3;
    }
  }
}

/* ============================================
   Error State (No JavaScript Fallback)
   ============================================ */
.contact-map__wrapper[data-error="true"] {
  background-color: var(--color-neutral-100);
  border: 2px dashed var(--color-border);
}

.contact-map__wrapper[data-error="true"]::before {
  display: none;
}

.contact-map__wrapper[data-error="true"]::after {
  content: 'Map could not be loaded. Please try refreshing the page.';
  color: var(--color-text-secondary);
  animation: none;
  opacity: 1;
  visibility: visible;
}